# fork(2)

fork()を呼び出すと呼び出し元のプロセスが複製される。
呼び出し元のプロセスを親プロセスと呼び、複製されたプロセスを子プロセスと呼ぶ。
fork()がコールされるとカーネルは子プロセス用のメモリ領域を用意しそこに親プロセスのメモリをコピーしたものを格納する。

子プロセスが自分の道を歩み始めるのはfork()から戻った地点である。
子プロセスではfork()の戻り値は0になる。
親プロセスのfork()の戻り値は子プロセスのプロセスidとなるがfork()が失敗した場合は-1が返る。
なので子プロセスでの処理を書きたい場合はfork()の戻り値で条件分岐することができる。

親子でメモリを共有しているように見えるが、そうではなくfork()時にカーネルがコピーしてくれているだけである。
なのでそれぞれの処理の中でメモリを割り当てたり、解放したりしても親や子には影響しない。

そもそも「プロセス」は定義上は互いにメモリ空間を共有していない処理のこと。
メモリ空間を共有する処理を「スレッド」と呼ぶ。
